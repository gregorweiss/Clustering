<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>clustering: Clustering::Density Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">clustering
   &#160;<span id="projectnumber">0.11</span>
   </div>
   <div id="projectbrief">Clustering suite for molecular dynamics trajectories.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceClustering.html">Clustering</a></li><li class="navelem"><a class="el" href="namespaceClustering_1_1Density.html">Density</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Clustering::Density Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>namespace for density-based clustering functions  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceClustering_1_1Density_1_1MPI"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density_1_1MPI.html">MPI</a></td></tr>
<tr class="memdesc:namespaceClustering_1_1Density_1_1MPI"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI implementations of compute intensive functions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceClustering_1_1Density_1_1OpenCL"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density_1_1OpenCL.html">OpenCL</a></td></tr>
<tr class="memdesc:namespaceClustering_1_1Density_1_1OpenCL"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenCL implementations of compute intensive functions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:structClustering_1_1Density_1_1BoxGrid"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#structClustering_1_1Density_1_1BoxGrid">BoxGrid</a></td></tr>
<tr class="separator:structClustering_1_1Density_1_1BoxGrid"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af77cfa169766fdc136b680121101496d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af77cfa169766fdc136b680121101496d"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#af77cfa169766fdc136b680121101496d">FreeEnergy</a> = std::pair&lt; std::size_t, float &gt;</td></tr>
<tr class="memdesc:af77cfa169766fdc136b680121101496d"><td class="mdescLeft">&#160;</td><td class="mdescRight">matches frame id to free energy <br /></td></tr>
<tr class="separator:af77cfa169766fdc136b680121101496d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3c667ff26944b877f55b8a20deb2ce7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac3c667ff26944b877f55b8a20deb2ce7"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#ac3c667ff26944b877f55b8a20deb2ce7">Neighbor</a> = <a class="el" href="namespaceClustering_1_1Tools.html#a63a5e933e8b64deefbb1128bbbdc3dd1">Clustering::Tools::Neighbor</a></td></tr>
<tr class="memdesc:ac3c667ff26944b877f55b8a20deb2ce7"><td class="mdescLeft">&#160;</td><td class="mdescRight">matches neighbor's frame id to distance <br /></td></tr>
<tr class="separator:ac3c667ff26944b877f55b8a20deb2ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23a99ccebc9d9cf5c9df6af14559d539"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a23a99ccebc9d9cf5c9df6af14559d539"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> = <a class="el" href="namespaceClustering_1_1Tools.html#ad2b6f4886446247db27ece196d76575c">Clustering::Tools::Neighborhood</a></td></tr>
<tr class="memdesc:a23a99ccebc9d9cf5c9df6af14559d539"><td class="mdescLeft">&#160;</td><td class="mdescRight">map frame id to neighbors <br /></td></tr>
<tr class="separator:a23a99ccebc9d9cf5c9df6af14559d539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34bf77e7411ef8004461f55c1e42d8f2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a34bf77e7411ef8004461f55c1e42d8f2"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a> = std::array&lt; int, 3 &gt;</td></tr>
<tr class="memdesc:a34bf77e7411ef8004461f55c1e42d8f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">encodes 3D box for box-assisted search algorithm <br /></td></tr>
<tr class="separator:a34bf77e7411ef8004461f55c1e42d8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a07a6658238b06f32df2b108fcfa9d438"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceClustering_1_1Density.html#structClustering_1_1Density_1_1BoxGrid">BoxGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a07a6658238b06f32df2b108fcfa9d438">compute_box_grid</a> (const float *coords, const std::size_t n_rows, const std::size_t n_cols, const float radius)</td></tr>
<tr class="separator:a07a6658238b06f32df2b108fcfa9d438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a448fe4bc43047910281875c4e0e78b13"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a448fe4bc43047910281875c4e0e78b13">neighbor_box</a> (const <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a> center, const int i_neighbor)</td></tr>
<tr class="separator:a448fe4bc43047910281875c4e0e78b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39916e623a97a8aabf26b37cb81ab37"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#ae39916e623a97a8aabf26b37cb81ab37">is_valid_box</a> (const <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a> box, const <a class="el" href="namespaceClustering_1_1Density.html#structClustering_1_1Density_1_1BoxGrid">BoxGrid</a> &amp;grid)</td></tr>
<tr class="separator:ae39916e623a97a8aabf26b37cb81ab37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70bfcb6c8250fb6db892e765380c5957"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70bfcb6c8250fb6db892e765380c5957"></a>
std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a70bfcb6c8250fb6db892e765380c5957">calculate_populations</a> (const float *coords, const std::size_t n_rows, const std::size_t n_cols, const float radius)</td></tr>
<tr class="memdesc:a70bfcb6c8250fb6db892e765380c5957"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate population of n-dimensional hypersphere per frame for one fixed radius. <br /></td></tr>
<tr class="separator:a70bfcb6c8250fb6db892e765380c5957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a709df0601b34b713d3fbb4a79e937c"><td class="memItemLeft" align="right" valign="top">std::map&lt; float, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a1a709df0601b34b713d3fbb4a79e937c">calculate_populations</a> (const float *coords, const std::size_t n_rows, const std::size_t n_cols, std::vector&lt; float &gt; radii)</td></tr>
<tr class="separator:a1a709df0601b34b713d3fbb4a79e937c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bc67a1fd0cfb678507e7f6eea991a48"><td class="memItemLeft" align="right" valign="top">std::vector&lt; float &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a9bc67a1fd0cfb678507e7f6eea991a48">calculate_free_energies</a> (const std::vector&lt; std::size_t &gt; &amp;pops)</td></tr>
<tr class="separator:a9bc67a1fd0cfb678507e7f6eea991a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c5ac7778d09db1fbd759e35338c7a4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespaceClustering_1_1Density.html#af77cfa169766fdc136b680121101496d">FreeEnergy</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#ab6c5ac7778d09db1fbd759e35338c7a4">sorted_free_energies</a> (const std::vector&lt; float &gt; &amp;fe)</td></tr>
<tr class="separator:ab6c5ac7778d09db1fbd759e35338c7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ad6788d0b10b1560092a19394319e5c"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a>, <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a2ad6788d0b10b1560092a19394319e5c">nearest_neighbors</a> (const float *coords, const std::size_t n_rows, const std::size_t n_cols, const std::vector&lt; float &gt; &amp;free_energy)</td></tr>
<tr class="separator:a2ad6788d0b10b1560092a19394319e5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9451b462c1ce38ac2a5fb5da6538282"><td class="memItemLeft" align="right" valign="top">std::set&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#ae9451b462c1ce38ac2a5fb5da6538282">high_density_neighborhood</a> (const float *coords, const std::size_t n_cols, const std::vector&lt; <a class="el" href="namespaceClustering_1_1Density.html#af77cfa169766fdc136b680121101496d">FreeEnergy</a> &gt; &amp;sorted_fe, const std::size_t i_frame, const std::size_t limit, const float max_dist)</td></tr>
<tr class="separator:ae9451b462c1ce38ac2a5fb5da6538282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92ef0c61760425c1c8ad5341d89b76a3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a92ef0c61760425c1c8ad5341d89b76a3">compute_sigma2</a> (const <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &amp;nh)</td></tr>
<tr class="separator:a92ef0c61760425c1c8ad5341d89b76a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ffa5e84e38620f39293be0486e8ef9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a96ffa5e84e38620f39293be0486e8ef9">assign_low_density_frames</a> (const std::vector&lt; std::size_t &gt; &amp;initial_clustering, const <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &amp;nh_high_dens, const std::vector&lt; float &gt; &amp;free_energy)</td></tr>
<tr class="separator:a96ffa5e84e38620f39293be0486e8ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7b2bae0fb60829edfba6b2ef3b1e5b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#ad7b2bae0fb60829edfba6b2ef3b1e5b2">main</a> (boost::program_options::variables_map args)</td></tr>
<tr class="separator:ad7b2bae0fb60829edfba6b2ef3b1e5b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad32c63c74da476d94d8e12813d45e750"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#ad32c63c74da476d94d8e12813d45e750">initial_density_clustering</a> (const std::vector&lt; float &gt; &amp;free_energy, const <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &amp;nh, const float free_energy_threshold, const float *coords, const std::size_t n_rows, const std::size_t n_cols, const std::vector&lt; std::size_t &gt; initial_clusters)</td></tr>
<tr class="separator:ad32c63c74da476d94d8e12813d45e750"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a47a5631c3ca56de274299029509bb931"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a47a5631c3ca56de274299029509bb931">BOX_DIFF</a> [27][3]</td></tr>
<tr class="separator:a47a5631c3ca56de274299029509bb931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9100d8226a5b20341fad7a6a281842c4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9100d8226a5b20341fad7a6a281842c4"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceClustering_1_1Density.html#a9100d8226a5b20341fad7a6a281842c4">N_NEIGHBOR_BOXES</a> = 27</td></tr>
<tr class="memdesc:a9100d8226a5b20341fad7a6a281842c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of neigbor boxes in cubic 3D grid (including center box). <br /></td></tr>
<tr class="separator:a9100d8226a5b20341fad7a6a281842c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>namespace for density-based clustering functions </p>
</div><hr/><h2 class="groupheader">Class Documentation</h2>
<a name="structClustering_1_1Density_1_1BoxGrid" id="structClustering_1_1Density_1_1BoxGrid"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Clustering::Density::BoxGrid</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>the full grid constructed for boxed-assisted nearest neighbor search with fixed distance criterion. </p>

<p>Definition at line <a class="el" href="density__clustering_8hpp_source.html#l00067">67</a> of file <a class="el" href="density__clustering_8hpp_source.html">density_clustering.hpp</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="afa7485c170c0de1020d9e0a2ae1c0887"></a>vector&lt; <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a> &gt;</td>
<td class="fieldname">
assigned_box</td>
<td class="fielddoc">
matching frame id to the frame's assigned box </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="adc569c320ff9120fe361fb1398c692bb"></a>map&lt; <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a>, vector&lt; int &gt; &gt;</td>
<td class="fieldname">
boxes</td>
<td class="fielddoc">
the boxes with a list of assigned frame ids </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac1f5ab2e679acbdec2e9d08a2a353059"></a>vector&lt; int &gt;</td>
<td class="fieldname">
n_boxes</td>
<td class="fielddoc">
total number of boxes </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a96ffa5e84e38620f39293be0486e8ef9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::size_t &gt; Clustering::Density::assign_low_density_frames </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>initial_clustering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &amp;&#160;</td>
          <td class="paramname"><em>nh_high_dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>free_energy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>given an initial clustering computed from free energy cutoff screenings, assign all yet unclustered frames (those in 'state 0') to their geometrically next cluster. do this by starting at the lowest free energy of unassigned frames, then assigning the next lowest, etc. thus, all initial clusters will be filled with growing free energy, effectively producing microstates separated close to the free energy barriers. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00340">340</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9bc67a1fd0cfb678507e7f6eea991a48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; float &gt; Clustering::Density::calculate_free_energies </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>re-use populations to calculate local free energy estimate via $ G = -k_B T \ln(P)$. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00208">208</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1a709df0601b34b713d3fbb4a79e937c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; float, std::vector&lt; std::size_t &gt; &gt; Clustering::Density::calculate_populations </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; float &gt;&#160;</td>
          <td class="paramname"><em>radii</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>calculate populations of n-dimensional hypersphere per frame for different radii in one go. computationally much more efficient than running single-radius version for every radius. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00136">136</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a07a6658238b06f32df2b108fcfa9d438"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceClustering_1_1Density.html#structClustering_1_1Density_1_1BoxGrid">BoxGrid</a> Clustering::Density::compute_box_grid </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>uses fixed radius to separate coordinate space in equally sized boxes for box-assisted nearest neighbor search. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00039">39</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a92ef0c61760425c1c8ad5341d89b76a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Clustering::Density::compute_sigma2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &amp;&#160;</td>
          <td class="paramname"><em>nh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>compute sigma2 as deviation of squared nearest-neighbor distances. sigma2 is given by E[x^2] &gt; Var(x) = E[x^2] - E[x]^2, with x being the distances between nearest neighbors). </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00329">329</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae9451b462c1ce38ac2a5fb5da6538282"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt; std::size_t &gt; Clustering::Density::high_density_neighborhood </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespaceClustering_1_1Density.html#af77cfa169766fdc136b680121101496d">FreeEnergy</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sorted_fe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>i_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>max_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>compute local neighborhood of a given frame. neighbor candidates are all frames below a given limit, effectively limiting the frames to the ones below a free energy cutoff. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00288">288</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad32c63c74da476d94d8e12813d45e750"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::size_t &gt; Clustering::Density::initial_density_clustering </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>free_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &amp;&#160;</td>
          <td class="paramname"><em>nh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>free_energy_threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt;&#160;</td>
          <td class="paramname"><em>initial_clusters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>returns state trajectory for clusters given by a free energy threshold. frames with a local free energy estimate higher than the given threshold will not be clustered and remain in 'state 0'. </p>

<p>Definition at line <a class="el" href="density__clustering__common_8cpp_source.html#l00037">37</a> of file <a class="el" href="density__clustering__common_8cpp_source.html">density_clustering_common.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae39916e623a97a8aabf26b37cb81ab37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Clustering::Density::is_valid_box </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a>&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceClustering_1_1Density.html#structClustering_1_1Density_1_1BoxGrid">BoxGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>returns true, if the box is a valid box in the grid. return false, if the box is outside of the grid. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00109">109</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad7b2bae0fb60829edfba6b2ef3b1e5b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Clustering::Density::main </td>
          <td>(</td>
          <td class="paramtype">boost::program_options::variables_map&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>user interface and controlling function for density-based geometric clustering.<br />
<br />
<em>parsed parameters</em>:<br />
</p><ul>
<li><b>file</b> : input file with coordinates<br />
</li>
<li><b>free-energy-input</b>: previously computed free energies (input)<br />
</li>
<li><b>free-energy</b>: computed free energies (output)<br />
</li>
<li><b>population</b>: computed populations (output)<br />
</li>
<li><b>output</b>: clustered trajectory<br />
</li>
<li><b>radii</b>: list of radii for free energy / population computations (input)<br />
</li>
<li><b>radius</b>: radius for clustering (input)<br />
</li>
<li><b>nearest-neighbors-input</b>: previously computed nearest neighbor list (input)<br />
</li>
<li><b>nearest-neighbors</b>: nearest neighbor list (output)<br />
</li>
<li><b>threshold-screening</b>: option for automated free energy threshold screening (input)<br />
</li>
<li><b>threshold</b>: threshold for single run with limited free energy (input)<br />
</li>
<li><b>only-initial</b>: if true, do not fill microstates up to barriers, but keep initial clusters below free energy cutoff (bool flag) </li>
</ul>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00358">358</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2ad6788d0b10b1560092a19394319e5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a>, <a class="el" href="namespaceClustering_1_1Density.html#a23a99ccebc9d9cf5c9df6af14559d539">Neighborhood</a> &gt; Clustering::Density::nearest_neighbors </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t&#160;</td>
          <td class="paramname"><em>n_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>free_energy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>for every frame: compute the nearest neighbor (first tuple field) and the nearest neighbor with lower free energy, i.e. higher density (second tuple field). </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00234">234</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a448fe4bc43047910281875c4e0e78b13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a> Clustering::Density::neighbor_box </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceClustering_1_1Density.html#a34bf77e7411ef8004461f55c1e42d8f2">Box</a>&#160;</td>
          <td class="paramname"><em>center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i_neighbor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>returns neighbor box given by neighbor index (in 3D: 27 different neighbors, including center itself) and the given center box. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00102">102</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab6c5ac7778d09db1fbd759e35338c7a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="namespaceClustering_1_1Density.html#af77cfa169766fdc136b680121101496d">FreeEnergy</a> &gt; Clustering::Density::sorted_free_energies </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>fe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>returns the given free energies sorted lowest to highest. original indices are retained. </p>

<p>Definition at line <a class="el" href="density__clustering_8cpp_source.html#l00221">221</a> of file <a class="el" href="density__clustering_8cpp_source.html">density_clustering.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a47a5631c3ca56de274299029509bb931"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int Clustering::Density::BOX_DIFF[27][3]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {{-1, 1,-1}, { 0, 1,-1}, { 1, 1,-1}</div>
<div class="line">                                   , {-1, 0,-1}, { 0, 0,-1}, { 1, 0,-1}</div>
<div class="line">                                   , {-1,-1,-1}, { 0,-1,-1}, { 1,-1,-1}</div>
<div class="line">                                   , {-1, 1, 0}, { 0, 1, 0}, { 1, 1, 0}</div>
<div class="line">                                   , {-1, 0, 0}, { 0, 0, 0}, { 1, 0, 0}</div>
<div class="line">                                   , {-1,-1, 0}, { 0,-1, 0}, { 1,-1, 0}</div>
<div class="line">                                   , {-1, 1, 1}, { 0, 1, 1}, { 1, 1, 1}</div>
<div class="line">                                   , {-1, 0, 1}, { 0, 0, 1}, { 1, 0, 1}</div>
<div class="line">                                   , {-1,-1, 1}, { 0,-1, 1}, { 1,-1, 1}}</div>
</div><!-- fragment --><p>encodes box differences in 3D, i.e. if you are at the center box, the 27 different tuples hold the steppings to the 27 spacial neighbors (including the center box itself). </p>

<p>Definition at line <a class="el" href="density__clustering_8hpp_source.html#l00054">54</a> of file <a class="el" href="density__clustering_8hpp_source.html">density_clustering.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 24 2015 21:29:12 for clustering by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
