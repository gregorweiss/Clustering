\hypertarget{namespaceClustering_1_1MPP}{\section{Clustering\-:\-:M\-P\-P Namespace Reference}
\label{namespaceClustering_1_1MPP}\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}}
}


functions related to \char`\"{}\-Most Probable Path\char`\"{}-\/clustering  


\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\hypertarget{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}{using \hyperlink{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}{Sparse\-Matrix\-F} = boost\-::numeric\-::ublas\-::mapped\-\_\-matrix$<$ float $>$}\label{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}

\begin{DoxyCompactList}\small\item\em B\-O\-O\-S\-T implementation of a sparse matrix for floats. \end{DoxyCompactList}\item 
\hypertarget{namespaceClustering_1_1MPP_a39c585c21d2f99427a870eb96ccc0510}{using \hyperlink{namespaceClustering_1_1MPP_a39c585c21d2f99427a870eb96ccc0510}{Neighborhood} = \hyperlink{namespaceClustering_1_1Tools_ad2b6f4886446247db27ece196d76575c}{Clustering\-::\-Tools\-::\-Neighborhood}}\label{namespaceClustering_1_1MPP_a39c585c21d2f99427a870eb96ccc0510}

\begin{DoxyCompactList}\small\item\em Neighborhood per frame. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}{Sparse\-Matrix\-F} \hyperlink{namespaceClustering_1_1MPP_a2851e170991a688c5abce05377f43a06}{transition\-\_\-counts} (std\-::vector$<$ std\-::size\-\_\-t $>$ trajectory, std\-::vector$<$ std\-::size\-\_\-t $>$ concat\-\_\-limits, std\-::size\-\_\-t n\-\_\-lag\-\_\-steps)
\item 
\hypertarget{namespaceClustering_1_1MPP_aebb74cbd76ee8b6f9324dd3b882b4b23}{\hyperlink{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}{Sparse\-Matrix\-F} \hyperlink{namespaceClustering_1_1MPP_aebb74cbd76ee8b6f9324dd3b882b4b23}{row\-\_\-normalized\-\_\-transition\-\_\-probabilities} (\hyperlink{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}{Sparse\-Matrix\-F} count\-\_\-matrix, std\-::set$<$ std\-::size\-\_\-t $>$ microstate\-\_\-names)}\label{namespaceClustering_1_1MPP_aebb74cbd76ee8b6f9324dd3b882b4b23}

\begin{DoxyCompactList}\small\item\em compute transition matrix from counts by normalization of rows \end{DoxyCompactList}\item 
std\-::map$<$ std\-::size\-\_\-t, \\*
std\-::size\-\_\-t $>$ \hyperlink{namespaceClustering_1_1MPP_a4bb2e82d60d7efc807597a46c435a8e3}{single\-\_\-step\-\_\-future\-\_\-state} (\hyperlink{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}{Sparse\-Matrix\-F} transition\-\_\-matrix, std\-::set$<$ std\-::size\-\_\-t $>$ cluster\-\_\-names, float q\-\_\-min, std\-::map$<$ std\-::size\-\_\-t, float $>$ min\-\_\-free\-\_\-energy)
\item 
std\-::map$<$ std\-::size\-\_\-t, \\*
std\-::vector$<$ std\-::size\-\_\-t $>$ $>$ \hyperlink{namespaceClustering_1_1MPP_ac794f6bda2f9a96c46300ae191dd9515}{most\-\_\-probable\-\_\-path} (std\-::map$<$ std\-::size\-\_\-t, std\-::size\-\_\-t $>$ future\-\_\-state, std\-::set$<$ std\-::size\-\_\-t $>$ cluster\-\_\-names)
\item 
\hypertarget{namespaceClustering_1_1MPP_ae25b19b43ae12a84dec8ed0206556286}{std\-::map$<$ std\-::size\-\_\-t, \\*
std\-::size\-\_\-t $>$ \hyperlink{namespaceClustering_1_1MPP_ae25b19b43ae12a84dec8ed0206556286}{microstate\-\_\-populations} (std\-::vector$<$ std\-::size\-\_\-t $>$ clusters, std\-::set$<$ std\-::size\-\_\-t $>$ cluster\-\_\-names)}\label{namespaceClustering_1_1MPP_ae25b19b43ae12a84dec8ed0206556286}

\begin{DoxyCompactList}\small\item\em compute cluster populations \end{DoxyCompactList}\item 
std\-::map$<$ std\-::size\-\_\-t, float $>$ \hyperlink{namespaceClustering_1_1MPP_a59c6293dca29ab7578334ba9c74b8ea1}{microstate\-\_\-min\-\_\-free\-\_\-energy} (const std\-::vector$<$ std\-::size\-\_\-t $>$ \&clustering, const std\-::vector$<$ float $>$ \&free\-\_\-energy)
\item 
std\-::map$<$ std\-::size\-\_\-t, \\*
std\-::size\-\_\-t $>$ \hyperlink{namespaceClustering_1_1MPP_ad62b2497eadb5bb6e66f7f500b8c372a}{path\-\_\-sinks} (std\-::vector$<$ std\-::size\-\_\-t $>$ clusters, std\-::map$<$ std\-::size\-\_\-t, std\-::vector$<$ std\-::size\-\_\-t $>$$>$ mpp, \hyperlink{namespaceClustering_1_1MPP_aab655de2feb4b56dd87bcc0fc6f13974}{Sparse\-Matrix\-F} transition\-\_\-matrix, std\-::set$<$ std\-::size\-\_\-t $>$ cluster\-\_\-names, float q\-\_\-min, std\-::vector$<$ float $>$ free\-\_\-energy)
\item 
std\-::vector$<$ std\-::size\-\_\-t $>$ \hyperlink{namespaceClustering_1_1MPP_afc4d7a9ced9fd7372555b1cdec9c3bc2}{lumped\-\_\-trajectory} (std\-::vector$<$ std\-::size\-\_\-t $>$ trajectory, std\-::map$<$ std\-::size\-\_\-t, std\-::size\-\_\-t $>$ sinks)
\item 
\hypertarget{namespaceClustering_1_1MPP_a57e887b44d8a2665d2f1fc93a2662af3}{std\-::tuple$<$ std\-::vector\\*
$<$ std\-::size\-\_\-t $>$, std\-::map\\*
$<$ std\-::size\-\_\-t, std\-::size\-\_\-t $>$ $>$ \hyperlink{namespaceClustering_1_1MPP_a57e887b44d8a2665d2f1fc93a2662af3}{fixed\-\_\-metastability\-\_\-clustering} (std\-::vector$<$ std\-::size\-\_\-t $>$ initial\-\_\-trajectory, std\-::vector$<$ std\-::size\-\_\-t $>$ concat\-\_\-limits, float q\-\_\-min, std\-::size\-\_\-t lagtime, std\-::vector$<$ float $>$ free\-\_\-energy)}\label{namespaceClustering_1_1MPP_a57e887b44d8a2665d2f1fc93a2662af3}

\begin{DoxyCompactList}\small\item\em run clustering for given Q\-\_\-min value \end{DoxyCompactList}\item 
void \hyperlink{namespaceClustering_1_1MPP_aee5ffda122e11568a073e97e4a316d89}{main} (boost\-::program\-\_\-options\-::variables\-\_\-map args)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
functions related to \char`\"{}\-Most Probable Path\char`\"{}-\/clustering 

\subsection{Function Documentation}
\hypertarget{namespaceClustering_1_1MPP_afc4d7a9ced9fd7372555b1cdec9c3bc2}{\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}!lumped\-\_\-trajectory@{lumped\-\_\-trajectory}}
\index{lumped\-\_\-trajectory@{lumped\-\_\-trajectory}!Clustering::MPP@{Clustering\-::\-M\-P\-P}}
\subsubsection[{lumped\-\_\-trajectory}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::size\-\_\-t $>$ Clustering\-::\-M\-P\-P\-::lumped\-\_\-trajectory (
\begin{DoxyParamCaption}
\item[{std\-::vector$<$ std\-::size\-\_\-t $>$}]{trajectory, }
\item[{std\-::map$<$ std\-::size\-\_\-t, std\-::size\-\_\-t $>$}]{sinks}
\end{DoxyParamCaption}
)}}\label{namespaceClustering_1_1MPP_afc4d7a9ced9fd7372555b1cdec9c3bc2}
lump states based on path sinks and return new trajectory. new microstates will have I\-Ds of sinks. 

Definition at line 238 of file mpp.\-cpp.

\hypertarget{namespaceClustering_1_1MPP_aee5ffda122e11568a073e97e4a316d89}{\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}!main@{main}}
\index{main@{main}!Clustering::MPP@{Clustering\-::\-M\-P\-P}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}void Clustering\-::\-M\-P\-P\-::main (
\begin{DoxyParamCaption}
\item[{boost\-::program\-\_\-options\-::variables\-\_\-map}]{args}
\end{DoxyParamCaption}
)}}\label{namespaceClustering_1_1MPP_aee5ffda122e11568a073e97e4a316d89}
M\-P\-P clustering control function and user interface\par
 {\itshape parsed arguments}\-:
\begin{DoxyItemize}
\item {\bfseries basename}\-: name format for output files
\item {\bfseries input}\-: input file with microstate trajectory
\item {\bfseries lagtime}\-: lag for transition estimation in units of frame numbers
\item {\bfseries qmin-\/from}\-: lower limit for metastability (Q\-\_\-min)
\item {\bfseries qmin-\/to}\-: upper limit for metastability (Q\-\_\-min)
\item {\bfseries qmin-\/step}\-: stepping for metastability (Q\-\_\-min)
\item {\bfseries concat-\/limits}\-: discontinuities for concatenated, non-\/uniformly long trajectories
\item {\bfseries concat-\/nframes}\-: number of frames per sub-\/trajectory for concatenated, uniformly long trajectories 
\end{DoxyItemize}

Definition at line 320 of file mpp.\-cpp.

\hypertarget{namespaceClustering_1_1MPP_a59c6293dca29ab7578334ba9c74b8ea1}{\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}!microstate\-\_\-min\-\_\-free\-\_\-energy@{microstate\-\_\-min\-\_\-free\-\_\-energy}}
\index{microstate\-\_\-min\-\_\-free\-\_\-energy@{microstate\-\_\-min\-\_\-free\-\_\-energy}!Clustering::MPP@{Clustering\-::\-M\-P\-P}}
\subsubsection[{microstate\-\_\-min\-\_\-free\-\_\-energy}]{\setlength{\rightskip}{0pt plus 5cm}std\-::map$<$ std\-::size\-\_\-t, float $>$ Clustering\-::\-M\-P\-P\-::microstate\-\_\-min\-\_\-free\-\_\-energy (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ std\-::size\-\_\-t $>$ \&}]{clustering, }
\item[{const std\-::vector$<$ float $>$ \&}]{free\-\_\-energy}
\end{DoxyParamCaption}
)}}\label{namespaceClustering_1_1MPP_a59c6293dca29ab7578334ba9c74b8ea1}
assign every state the lowest free energy value of all of its frames. 

Definition at line 167 of file mpp.\-cpp.

\hypertarget{namespaceClustering_1_1MPP_ac794f6bda2f9a96c46300ae191dd9515}{\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}!most\-\_\-probable\-\_\-path@{most\-\_\-probable\-\_\-path}}
\index{most\-\_\-probable\-\_\-path@{most\-\_\-probable\-\_\-path}!Clustering::MPP@{Clustering\-::\-M\-P\-P}}
\subsubsection[{most\-\_\-probable\-\_\-path}]{\setlength{\rightskip}{0pt plus 5cm}std\-::map$<$ std\-::size\-\_\-t, std\-::vector$<$ std\-::size\-\_\-t $>$ $>$ Clustering\-::\-M\-P\-P\-::most\-\_\-probable\-\_\-path (
\begin{DoxyParamCaption}
\item[{std\-::map$<$ std\-::size\-\_\-t, std\-::size\-\_\-t $>$}]{future\-\_\-state, }
\item[{std\-::set$<$ std\-::size\-\_\-t $>$}]{cluster\-\_\-names}
\end{DoxyParamCaption}
)}}\label{namespaceClustering_1_1MPP_ac794f6bda2f9a96c46300ae191dd9515}
for every state, compute most probable path by following the 'future\-\_\-state'-\/mapping recursively 

Definition at line 135 of file mpp.\-cpp.

\hypertarget{namespaceClustering_1_1MPP_ad62b2497eadb5bb6e66f7f500b8c372a}{\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}!path\-\_\-sinks@{path\-\_\-sinks}}
\index{path\-\_\-sinks@{path\-\_\-sinks}!Clustering::MPP@{Clustering\-::\-M\-P\-P}}
\subsubsection[{path\-\_\-sinks}]{\setlength{\rightskip}{0pt plus 5cm}std\-::map$<$ std\-::size\-\_\-t, std\-::size\-\_\-t $>$ Clustering\-::\-M\-P\-P\-::path\-\_\-sinks (
\begin{DoxyParamCaption}
\item[{std\-::vector$<$ std\-::size\-\_\-t $>$}]{clusters, }
\item[{std\-::map$<$ std\-::size\-\_\-t, std\-::vector$<$ std\-::size\-\_\-t $>$$>$}]{mpp, }
\item[{Sparse\-Matrix\-F}]{transition\-\_\-matrix, }
\item[{std\-::set$<$ std\-::size\-\_\-t $>$}]{cluster\-\_\-names, }
\item[{float}]{q\-\_\-min, }
\item[{std\-::vector$<$ float $>$}]{free\-\_\-energy}
\end{DoxyParamCaption}
)}}\label{namespaceClustering_1_1MPP_ad62b2497eadb5bb6e66f7f500b8c372a}
compute path sinks, i.\-e. states of highest metastability, and lowest free energy per path. these sinks will be states all other states of the given path will be lumped into. 

Definition at line 184 of file mpp.\-cpp.

\hypertarget{namespaceClustering_1_1MPP_a4bb2e82d60d7efc807597a46c435a8e3}{\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}!single\-\_\-step\-\_\-future\-\_\-state@{single\-\_\-step\-\_\-future\-\_\-state}}
\index{single\-\_\-step\-\_\-future\-\_\-state@{single\-\_\-step\-\_\-future\-\_\-state}!Clustering::MPP@{Clustering\-::\-M\-P\-P}}
\subsubsection[{single\-\_\-step\-\_\-future\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}std\-::map$<$ std\-::size\-\_\-t, std\-::size\-\_\-t $>$ Clustering\-::\-M\-P\-P\-::single\-\_\-step\-\_\-future\-\_\-state (
\begin{DoxyParamCaption}
\item[{Sparse\-Matrix\-F}]{transition\-\_\-matrix, }
\item[{std\-::set$<$ std\-::size\-\_\-t $>$}]{cluster\-\_\-names, }
\item[{float}]{q\-\_\-min, }
\item[{std\-::map$<$ std\-::size\-\_\-t, float $>$}]{min\-\_\-free\-\_\-energy}
\end{DoxyParamCaption}
)}}\label{namespaceClustering_1_1MPP_a4bb2e82d60d7efc807597a46c435a8e3}
compute immediate future (i.\-e. without lag) of every state from highest probable transitions; exclude self-\/transitions. 

Definition at line 85 of file mpp.\-cpp.

\hypertarget{namespaceClustering_1_1MPP_a2851e170991a688c5abce05377f43a06}{\index{Clustering\-::\-M\-P\-P@{Clustering\-::\-M\-P\-P}!transition\-\_\-counts@{transition\-\_\-counts}}
\index{transition\-\_\-counts@{transition\-\_\-counts}!Clustering::MPP@{Clustering\-::\-M\-P\-P}}
\subsubsection[{transition\-\_\-counts}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Sparse\-Matrix\-F} Clustering\-::\-M\-P\-P\-::transition\-\_\-counts (
\begin{DoxyParamCaption}
\item[{std\-::vector$<$ std\-::size\-\_\-t $>$}]{trajectory, }
\item[{std\-::vector$<$ std\-::size\-\_\-t $>$}]{concat\-\_\-limits, }
\item[{std\-::size\-\_\-t}]{n\-\_\-lag\-\_\-steps}
\end{DoxyParamCaption}
)}}\label{namespaceClustering_1_1MPP_a2851e170991a688c5abce05377f43a06}
count transitions from one to the other cluster with certain lag and return as count matrix (row/col \-:= from/to) 

Definition at line 33 of file mpp.\-cpp.

